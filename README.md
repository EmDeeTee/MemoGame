Somebody else's Java code that I translated to C# and attempted to improve 
